<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Clientes</ion-title>
    <button onclick="window.location.href='/home'" class="nav-link">‚¨Ö Volver</button>

  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="page-container">

    <!-- CARD 1: FORM -->
    <div class="card">
      <div *ngIf="mensajeError" class="error-box">‚ö†Ô∏è {{ mensajeError }}</div>

      <h2 class="card-title">{{ modoEdicion ? "‚úèÔ∏è Editar Cliente" : "‚ûï Nuevo Cliente" }}</h2>

      <form (ngSubmit)="guardar()">
        <label class="label">RUT *</label>
        <input class="input" [(ngModel)]="cliente.rut" name="rut" required placeholder="Ej: 12.345.678-9" />

        <label class="label">Nombre / Raz√≥n Social *</label>
        <input class="input" [(ngModel)]="cliente.nombre_razon" name="nombre_razon" required placeholder="Ej: Mi Empresa S.A." />

        <label class="label">Email *</label>
        <input class="input" [(ngModel)]="cliente.email_contacto" name="email_contacto" type="email" required placeholder="info@empresa.com" />

        <label class="label">Tel√©fono</label>
        <input class="input" [(ngModel)]="cliente.telefono" name="telefono" placeholder="+56912345678" />

        <label class="label">Direcci√≥n *</label>
        <input class="input" [(ngModel)]="cliente.direccion_facturacion" name="direccion_facturacion" required placeholder="Calle 123" />

        <label class="label">Ciudad</label>
        <input class="input" [(ngModel)]="cliente.ciudad" name="ciudad" placeholder="Santiago" />

        <div class="button-row">
          <button type="submit" [disabled]="cargando" class="btn-primary">
            {{ cargando ? "‚è≥ Guardando..." : (modoEdicion ? "üíæ Actualizar" : "‚ûï Crear") }}
          </button>
          <button type="button" class="btn-danger" (click)="cancelar()" [disabled]="cargando">‚ùå Cancelar</button>
        </div>
      </form>

      <div class="note">Los campos marcados con (*) son requeridos.</div>
    </div>

    <!-- CARD 2: LIST -->
    <div class="card card-lista">
      <h2 class="card-title">Lista de Clientes</h2>

      <div *ngIf="cargando" class="muted">Cargando clientes...</div>
      <div *ngIf="!cargando && clientes.length === 0" class="muted">No hay clientes registrados.</div>

      <div *ngIf="clientes.length > 0" class="table-wrap">
        <table class="tabla-clientes">
          <thead>
            <tr>
              <th>RUT</th>
              <th>Nombre / Raz√≥n</th>
              <th>Email</th>
              <th>Tel√©fono</th>
              <th>Direcci√≥n</th>
              <th>Ciudad</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of clientes">
              <td>{{ c.rut }}</td>
              <td>{{ c.nombre_razon }}</td>
              <td>{{ c.email_contacto }}</td>
              <td>{{ c.telefono }}</td>
              <td>{{ c.direccion_facturacion }}</td>
              <td>{{ c.ciudad }}</td>
              <td class="td-actions">
                <button class="btn-primary" (click)="editarCliente(c)">‚úèÔ∏è Editar</button>
                <button class="btn-danger" (click)="eliminarCliente(c.id_cliente || c.id)">üóë Eliminar</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

  </div>
</ion-content>
